{
    "name": "Synchronous Machine",
    "parameters": [
        {
            "name": "VLL",
            "desc": "Terminal line-to-line RMS voltage",
            "units":  "V",
            "default": 4160.0
        },
        {
            "name": "ws",
            "desc": "Electrical synchronous speed",
            "units": "rad/s",
            "default": 4160.0
        },
        {
            "name": "P",
            "desc": "Number of poles",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "rs",
            "desc": "Stator resistance",
            "units": "Ohm",
            "default": 4160.0
        },
        {
            "name": "Lls",
            "desc": "Stator leakage inductance",
            "units": "H",
            "default": 4160.0
        },
        {
            "name": "Lmq",
            "desc": "Q-axis mutual inductance",
            "units": "H",
            "default": 4160.0
        },
        {
            "name": "Lmd",
            "desc": "D-axis mutual inductance",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "rkq",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "Llkq",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "rkd",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "Llkd",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "rfd",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "Llfd",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "vfdb",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "Kp",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "Kp",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "Ki",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "J",
            "desc": "",
            "units": "",
            "default": 4160.0
        },
        {
            "name": "vfd",
            "desc": "",
            "units": "",
            "default": 4160.0
        }
    ],
    "states": [
        {
            "name": "fkq",
            "desc": "Q-axis flux",
            "units": "Wb",
            "derivative": "dfkq_dt"
        },
        {
            "name": "fkd",
            "desc": "D-axis flux",
            "units": "Wb",
            "derivative": "dfkd_dt"
        },
        {
            "name": "ffd",
            "desc": "Field winding flux",
            "units": "Wb",
            "derivative": "dffd_dt"
        },

        {
            "name": "wr",
            "desc": "Rotor speed",
            "units": "rad/s",
            "derivative": "dwr_dt"
        },
        {
            "name": "th",
            "desc": "Rotor angle",
            "units": "rad",
            "derivative": "dth_dt"
        },
        {
            "name": "iqs",
            "desc": "Q-axis terminal current",
            "units": "A",
            "derivative": "diqs_dt"
        },
        {
            "name": "ids",
            "desc": "D-axis terminal current",
            "units": "A",
            "derivative": "dids_dt"
        }
    ],
    "ports": [
        {
            "name": "Electrical Terminal",
            "type": "dq",
            "input": [ "vds", "vqs" ],
            "output":  ["ids", "iqs"]
        }
    ],
    "algebraic": [
        {
            "name": "Lq",
            "desc": "Equivalent q-axis Inductance",
            "units": "H",
            "expr": "Lls + (Lmq * Llkq) / (Llkq + Lmq)"
        },
        {
            "name": "Ld",
            "desc": "Equivalent d-axis Inductance",
            "units": "H",
            "expr": "Lls + (Lmd * Llfd * Llkd) / (Lmd * Llfd + Lmd * Llkd + Llfd * Llkd)"
        },
        {
            "name": "fq",
            "desc": "Q-axis flux",
            "units": "Wb",
            "expr": "Lmq / (Lmq + Llkq) * fkq\")"
        },
        {
            "name": "fd",
            "desc": "D-axis flux",
            "units": "Wb",
            "expr": "Lmd * (Lmd * (fkd / Llkd + ffd / Llfd)) / (1 + Lmd / Llfd + Lmd / Llkd)\")"
        },
        {
            "name": "Te",
            "desc": "Electrical torque",
            "units": "N.m",
            "expr": "3/2 * P/2 * (fds * iqs - fqs * ids)\")"
        },
        {
            "name": "Tm",
            "desc": "Mechanical torque",
            "units": "N.m",
            "expr": "Kp * (ws - wr) + th * Ki\")"
        }
    ],
    "diffeq": [
        "diqs_dt * Lls + rs * iqs + wr * Ld + wr * fd - vqs",
        "dids_dt * Lls + rs * ids - wr * Lq - wr * fq - vds",
        "dfkq_dt * Llkq + rkq * (fkq - Lq * iqs - fq + Lls * iqs)",
        "dfkd_dt * Llkd + rkd * (fkd - Ld * ids + fd + Lls * ids)",
        "dffd_dt * Llfd + rfd * (ffd - Ld * ids + fd + Lls * ids) - vfd",
        "dwr_dt * J + Tm - Te",
        "dth_dt + wr - ws"
    ]
}